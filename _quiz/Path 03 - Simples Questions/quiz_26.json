{
  "quiz": {
    "instructions": "This quiz contains 20 questions covering various aspects of Google Cloud Platform for Data Engineering. Validate your knowledge of SQL queries, machine learning, and data pipelines.",
    "questions": [
      {
        "questionText": "How do you standardize a column in a BigQuery table?",
        "options": [
          "Using the STDDEV() function",
          "Using the ZSCORE() function",
          "Using the STANDARDIZE() function",
          "Using the AVG() function"
        ],
        "answerIndex": [1],
        "explanation": "The ZSCORE() function can be used to standardize a column in BigQuery.",
        "validationQuery": "SELECT column, (column - AVG(column) OVER()) / STDDEV(column) OVER() AS standardized_column FROM my_table;"
      },
      {
        "questionText": "Which BigQuery function is used to replace all occurrences of a substring?",
        "options": [
          "REPLACE()",
          "SUBSTITUTE()",
          "TRANSLATE()",
          "REGEXP_REPLACE()"
        ],
        "answerIndex": [3],
        "explanation": "REGEXP_REPLACE() is used to replace all occurrences of a substring in BigQuery.",
        "validationQuery": "SELECT REGEXP_REPLACE(column, r'pattern', 'replacement') FROM my_table;"
      },
      {
        "questionText": "How would you create a linear regression model in BigQuery ML?",
        "options": [
          "CREATE MODEL my_model OPTIONS(model_type='linear_reg') AS SELECT * FROM my_table;",
          "CREATE MODEL my_model OPTIONS(model_type='logistic_reg') AS SELECT * FROM my_table;",
          "CREATE MODEL my_model OPTIONS(model_type='kmeans') AS SELECT * FROM my_table;",
          "CREATE MODEL my_model OPTIONS(model_type='autoencoder') AS SELECT * FROM my_table;"
        ],
        "answerIndex": [0],
        "explanation": "CREATE MODEL with model_type='linear_reg' is used to create a linear regression model in BigQuery ML.",
        "validationQuery": "CREATE OR REPLACE MODEL my_linear_model OPTIONS(model_type='linear_reg') AS SELECT * FROM my_table;"
      },
      {
        "questionText": "Which gcloud command would you use to list all active Dataflow jobs?",
        "options": [
          "gcloud dataflow jobs describe",
          "gcloud dataflow jobs list",
          "gcloud dataflow jobs cancel",
          "gcloud dataflow jobs show"
        ],
        "answerIndex": [1],
        "explanation": "The command 'gcloud dataflow jobs list' is used to list all active Dataflow jobs.",
        "validationCommand": "gcloud dataflow jobs list"
      },
      {
        "questionText": "How do you perform one-hot encoding in BigQuery?",
        "options": [
          "Using CASE WHEN statements",
          "Using the PIVOT function",
          "Using the ENCODE() function",
          "Using ARRAY_AGG()"
        ],
        "answerIndex": [0],
        "explanation": "One-hot encoding can be performed using CASE WHEN statements in BigQuery.",
        "validationQuery": "SELECT column, CASE WHEN column = 'category1' THEN 1 ELSE 0 END AS category1, CASE WHEN column = 'category2' THEN 1 ELSE 0 END AS category2 FROM my_table;"
      },
      {
        "questionText": "Which SQL function in BigQuery returns the day of the week from a DATE or TIMESTAMP?",
        "options": [
          "DAYOFWEEK()",
          "EXTRACT(DAYOFWEEK FROM ...)",
          "DATE_PART('day_of_week', ...)",
          "GET_DAYOFWEEK()"
        ],
        "answerIndex": [1],
        "explanation": "The EXTRACT function with DAYOFWEEK is used to return the day of the week from a DATE or TIMESTAMP.",
        "validationQuery": "SELECT EXTRACT(DAYOFWEEK FROM date_column) FROM my_table;"
      },
      {
        "questionText": "What is the purpose of the TRANSFORM clause in BigQuery ML?",
        "options": [
          "To preprocess input data before training a model",
          "To transform model predictions",
          "To tune model hyperparameters",
          "To transform feature columns during evaluation"
        ],
        "answerIndex": [0],
        "explanation": "The TRANSFORM clause is used to preprocess input data before training a model in BigQuery ML.",
        "validationQuery": "CREATE OR REPLACE MODEL my_model OPTIONS(model_type='linear_reg', input_label_cols=['label']) AS SELECT * FROM my_table TRANSFORM(label);"
      },
      {
        "questionText": "Which gcloud command would you use to run a Dataflow job using a Python script?",
        "options": [
          "gcloud dataflow jobs run",
          "gcloud dataflow jobs submit python",
          "gcloud dataflow pipelines run",
          "gcloud dataflow jobs create"
        ],
        "answerIndex": [1],
        "explanation": "The command 'gcloud dataflow jobs submit python' is used to run a Dataflow job using a Python script.",
        "validationCommand": "gcloud dataflow jobs submit python my_script.py --region=us-central1 --staging-location=gs://my-bucket/staging --temp-location=gs://my-bucket/temp"
      },
      {
        "questionText": "How do you calculate the rolling average of a column in BigQuery?",
        "options": [
          "Using the AVG() function with a window specification",
          "Using the MOVING_AVG() function",
          "Using the ROLLING() function",
          "Using the AVG() function without any window specification"
        ],
        "answerIndex": [0],
        "explanation": "The AVG() function with a window specification can be used to calculate the rolling average in BigQuery.",
        "validationQuery": "SELECT column, AVG(column) OVER (ORDER BY date_column ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS rolling_avg FROM my_table;"
      },
      {
        "questionText": "Which SQL function in BigQuery is used to calculate the correlation between two columns?",
        "options": [
          "CORR()",
          "COVAR()",
          "CORRELATE()",
          "PEARSON_CORR()"
        ],
        "answerIndex": [0],
        "explanation": "The CORR() function is used to calculate the Pearson correlation coefficient between two columns in BigQuery.",
        "validationQuery": "SELECT CORR(column1, column2) FROM my_table;"
      },
      {
        "questionText": "How do you filter a PCollection in Apache Beam?",
        "options": [
          "Using beam.Filter()",
          "Using beam.Map()",
          "Using beam.FlatMap()",
          "Using beam.GroupByKey()"
        ],
        "answerIndex": [0],
        "explanation": "beam.Filter() is used to filter elements in a PCollection based on a condition.",
        "validationCommand": "pcollection | 'FilterAdults' >> beam.Filter(lambda x: x['age'] > 18)"
      },
      {
        "questionText": "Which SQL function is used to create lag features in BigQuery?",
        "options": [
          "LAG()",
          "LEAD()",
          "ROW_NUMBER()",
          "RANK()"
        ],
        "answerIndex": [0],
        "explanation": "The LAG() function is used to create lag features in time-series data in BigQuery.",
        "validationQuery": "SELECT column, LAG(column, 1) OVER (ORDER BY date_column) AS prev_column FROM my_table;"
      },
      {
        "questionText": "How do you create a clustering model in BigQuery ML?",
        "options": [
          "CREATE MODEL my_model OPTIONS(model_type='linear_reg') AS SELECT * FROM my_table;",
          "CREATE MODEL my_model OPTIONS(model_type='logistic_reg') AS SELECT * FROM my_table;",
          "CREATE MODEL my_model OPTIONS(model_type='kmeans') AS SELECT * FROM my_table;",
          "CREATE MODEL my_model OPTIONS(model_type='autoencoder') AS SELECT * FROM my_table;"
        ],
        "answerIndex": [2],
        "explanation": "CREATE MODEL with model_type='kmeans' is used to create a clustering model in BigQuery ML.",
        "validationQuery": "CREATE OR REPLACE MODEL my_kmeans_model OPTIONS(model_type='kmeans') AS SELECT * FROM my_table;"
      },
      {
        "questionText": "Which gcloud command is used to create a Dataproc cluster?",
        "options": [
          "gcloud dataproc clusters create",
          "gcloud dataproc clusters build",
          "gcloud dataproc clusters start",
          "gcloud dataproc clusters init"
        ],
        "answerIndex": [0],
        "explanation": "The command 'gcloud dataproc clusters create' is used to create a new Dataproc cluster.",
        "validationCommand": "gcloud dataproc clusters create my-cluster --region=us-central1 --zone=us-central1-a --master-machine-type=n1-standard-1 --worker-machine-type=n1-standard-1"
      },
      {
        "questionText": "What is the command to install Apache Beam in a Python environment?",
        "options": [
          "pip install beam",
          "pip install apache-beam",
          "pip install google-beam",
          "pip install beam-pipeline"
        ],
        "answerIndex": [1],
        "explanation": "The command 'pip install apache-beam' is used to install Apache Beam in a Python environment."
      },
      {
        "questionText": "How do you create a feature cross in BigQuery ML?",
        "options": [
          "Using CONCAT() function",
          "Using CROSS() function",
          "Using FEATURE_CROSS() function",
          "Using BigQuery ML TRANSFORM clause"
        ],
        "answerIndex": [0],
        "explanation": "The CONCAT() function can be used to create a feature cross in BigQuery ML.",
        "validationQuery": "SELECT CONCAT(feature1, '_', feature2) AS feature_cross FROM my_table;"
      },
      {
        "questionText": "Which SQL function is used to extract a substring in BigQuery?",
        "options": [
          "SUBSTRING()",
          "SUBSTR()",
          "STR_EXTRACT()",
          "STRING_SPLIT()"
        ],
        "answerIndex": [1],
        "explanation": "The SUBSTR() function is used to extract a substring from a string in BigQuery.",
        "validationQuery": "SELECT SUBSTR(column, 1, 5) AS substring FROM my_table;"
      },
      {
        "questionText": "What is the command to deploy a Vertex AI custom training job?",
        "options": [
          "gcloud ai custom-jobs create",
          "gcloud ai custom-jobs submit",
          "gcloud ai custom-jobs run",
          "gcloud ai custom-jobs deploy"
        ],
        "answerIndex": [0],
        "explanation": "The command 'gcloud ai custom-jobs create' is used to deploy a custom training job in Vertex AI.",
        "validationCommand": "gcloud ai custom-jobs create --region=us-central1 --display-name=my_custom_job --python-package-uris=gs://my-bucket/my_script.py --script=my_script.py"
      },
      {
        "questionText": "How do you calculate the mean absolute error (MAE) in BigQuery ML?",
        "options": [
          "Using ML.MEAN_ABSOLUTE_ERROR()",
          "Using ML.EVALUATE()",
          "Using ML.PREDICT()",
          "Using ML.TRAIN()"
        ],
        "answerIndex": [1],
        "explanation": "ML.EVALUATE() can be used to calculate the mean absolute error (MAE) for a model in BigQuery ML.",
        "validationQuery": "SELECT * FROM ML.EVALUATE(MODEL my_model, TABLE my_table)"
      },
      {
        "questionText": "How do you create a Dataflow template for reuse?",
        "options": [
          "Using the --template_location flag with gcloud dataflow jobs run",
          "Using the --template flag with gcloud dataflow jobs submit",
          "Using the --template flag with gcloud dataflow pipelines run",
          "Using the --template_location flag with gcloud dataflow jobs create"
        ],
        "answerIndex": [0],
        "explanation": "The --template_location flag with 'gcloud dataflow jobs run' can be used to create a reusable Dataflow template.",
        "validationCommand": "gcloud dataflow jobs run my-job --gcs-location=gs://my-bucket/template --template-location=gs://my-bucket/template"
      }
    ]
  }
}
